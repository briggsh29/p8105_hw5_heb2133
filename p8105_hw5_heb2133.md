Homework 5
================

``` r
library(tidyverse)
```

    ## -- Attaching packages -------------------- tidyverse 1.3.0 --

    ## v ggplot2 3.3.2     v purrr   0.3.4
    ## v tibble  3.0.3     v dplyr   1.0.2
    ## v tidyr   1.1.2     v stringr 1.4.0
    ## v readr   1.3.1     v forcats 0.5.0

    ## -- Conflicts ----------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
knitr::opts_chunk$set(
  fig.width = 6, 
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis", 
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

Read in data

``` r
homicide_df = 
  read.csv("./data/homicide-data.csv") %>% 
  janitor::clean_names()
```

This dataset is from the Washington Post, which mapped over 52,000
homicides and any resulting arrests within 50 of the largest cities in
America. Key variables in this dataset include Report date; Victim name,
age, and sex; City; State; Latitude and longitude; and the Disposition.
There are 52179 rows and 12 columns in this raw dataset. e

``` r
homicide_df =
  homicide_df %>% 
  unite("city_state", city:state, sep = "_", remove = TRUE) %>% 
  mutate(
    resolved = case_when(
      disposition == "Closed without arrest" ~ "unsolved",
      disposition == "Open/No arrest"        ~ "unsolved",
      disposition == "Closed by arrest"      ~ "solved")
  ) 

homicide_df %>% 
  group_by(city_state) %>% 
  summarise(
    total_homicides = n(),
    unsolved_homicides = sum(resolved == "unsolved")
  )
```

    ## `summarise()` ungrouping output (override with `.groups` argument)

    ## # A tibble: 51 x 3
    ##    city_state     total_homicides unsolved_homicides
    ##    <chr>                    <int>              <int>
    ##  1 Albuquerque_NM             378                146
    ##  2 Atlanta_GA                 973                373
    ##  3 Baltimore_MD              2827               1825
    ##  4 Baton Rouge_LA             424                196
    ##  5 Birmingham_AL              800                347
    ##  6 Boston_MA                  614                310
    ##  7 Buffalo_NY                 521                319
    ##  8 Charlotte_NC               687                206
    ##  9 Chicago_IL                5535               4073
    ## 10 Cincinnati_OH              694                309
    ## # ... with 41 more rows
